<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Блог Ильи Барышева - Илья Барышев</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Илья Барышев">

    <link rel="stylesheet" href="http://codecoffee.ru/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://codecoffee.ru/theme/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="http://codecoffee.ru/theme/css/font-awesome.css" rel="stylesheet">
    <link href="http://codecoffee.ru/theme/css/pygments.css" rel="stylesheet">
    <link href="http://fonts.googleapis.com/css?family=Cuprum:400,700&subset=latin,cyrillic" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Play&subset=latin,cyrillic' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="http://codecoffee.ru/theme/css/my.css" type="text/css"/>

    <!--[if lt IE 9]>
    <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="shortcut icon" href="http://codecoffee.ru/theme/images/favicon.ico">
    <link rel="apple-touch-icon" href="http://codecoffee.ru/theme/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://codecoffee.ru/theme/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://codecoffee.ru/theme/images/apple-touch-icon-114x114.png">

    <link href="http://codecoffee.ru/rss.xml" type="application/rss+xml" rel="alternate" title="Блог Ильи Барышева RSS Feed"/>
</head>

<body>

<div class="container-fluid all-content">
    <div class="row">
        <header class="site-title span8 offset4">
            <h1 class="site-title-main"><a href="http://codecoffee.ru">Блог Ильи Барышева</a></h1>
            <span class="site-title-sub">О веб-разработке и не только…</span>
        </header>

        <div class="span8" id="content">
        <article class="article">
            <h2><a href="http://codecoffee.ru/2013/02/coveralls/">Coveralls for python</a></h2>
            <span class="article-date">25 February 2013</span>
            <div class="summary"><p>There is one awesome service to show off the test coverage of your project: <a href="https://coveralls.io/">Coveralls</a>.
Besides it's cool name, it has a lot of advantages to offer for opensource developer:
visualisation of repo coverage, history of your stats, individual file coverage reports.</p>
<p><a href="https://coveralls.io/">
<img src="/static/images/coveralls.png" width="660" height="290" alt="Coveralls promo"/></a></p>
<p>The killer feature is definitely Github and <a href="https://travis-ci.org/">Travis CI</a> integration. Simply log in with
your github account, choose repos to track coverage, add 2 lines to your Travis CI
config and you're all set.</p>
<p>It even checks coverage for your <a href="https://github.com/coagulant/django-twitter-tag/pull/23">pull requests</a>
and provides nice badges to embed in your docs:
<a href="https://coveralls.io/r/coagulant/coveralls-python"><img alt="Coverage Status" src="https://coveralls.io/repos/coagulant/coveralls-python/badge.png?branch=master" /></a></p>
<h2>Show me the code</h2>
<p>Ruby/rails are officially supported, everyobdy else can use json API.
So I've written a very simple <a href="https://github.com/coagulant/coveralls-python">python library</a> to use coveralls in my projects:</p>
<div class="highlight"><pre><span class="n">pip</span> <span class="n">install</span> <span class="n">coveralls</span>
</pre></div>


<p>After running tests with coverage, simply run <code>coveralls</code> console command
and that's it.</p>
<div class="highlight"><pre><span class="n">coverage</span> <span class="n">run</span> <span class="n">your_test_suite_runner</span><span class="p">.</span><span class="n">py</span>
<span class="n">coveralls</span>
</pre></div>


<p>If you're not using Travis CI you need a bit of extra configuration, explained in <a href="https://github.com/coagulant/coveralls-python#configuration">the docs</a>.
I've been using coveralls myself for some time and it's great.</p>
<p>It makes custom report for data generated by coverage.py package and sends it to json API
of coveralls.io service. All python files in your coverage analysis are posted to this service
along with coverage stats, so please make sure you're not ruining your own security!
For private projects there is Coveralls Pro.</p>
<h2>Conclusion</h2>
<p>Did I mention that service is completely free for opensource repos and offers plans for private ones?</p>
<p>I'm not an author of the service, I simply like the idea of sharing coverage
stats for OSS projects and the implementation of coveralls.io by <a href="http://lemurheavy.com">LemurHeavy</a>.
Thank you, guys!</p></div>
<div class="article-tags">
    <i class="icon-tag"></i>
	<a href="http://codecoffee.ru/tag/python.html">python</a>
	<a href="http://codecoffee.ru/tag/testing.html">testing</a>
</div>
            <a class="comments-link" href="http://codecoffee.ru/2013/02/coveralls/#disqus_thread">Комментарии</a>
        </article>
        <hr />
        <article class="article">
            <h2><a href="http://codecoffee.ru/2013/02/python3-moscowdjango/">Про то как я Moscowdjango на Python 3 портировал</a></h2>
            <span class="article-date">12 February 2013</span>
            <div class="summary"><p>В январе удалось вновь выступить на Moscow Django. <a href="http://moscowdjango.ru/meetup/9/whats-new-in-django15/">Доклад про новинки пока ещё не вышедшего Django 1.5</a>
оказался намного динамичней и бодрей прошлогоднего дебюта <a href="http://moscowdjango.ru/meetup/2/whats-new-in-django-14/">про 1.4</a>. По ссылкам можно в этом
убедиться воочию.</p>
<p>Как ни странно, в этот раз важных фич совсем немного, а ведь в прошлый раз их хватило,
чтобы написать целый <a href="http://blog.futurecolors.ru/2012/04/django-14.html">цикл из 8 статей в блоге Future Colors</a>. В сухом остатке настраиваемая
модель пользователя и небольшие улучшения в ORM и шаблонах. Про всё это уже многие написали. Даже <a href="http://blog.e0ne.info/post/Django-15-Release-Candidate.aspx">про
минорные</a>, но от того не менее приятные новинки. Но самое главное, это, конечно же, поддежка python 3.2+.</p>
<h3>Всё плохо?</h3>
<p>После <a href="http://moscowdjango.ru/meetup/8/whats-new-python3/">доклада Павла Зиновкина</a> про то, как они пробовали перевести на python 3 один
из своих проектов, у меня сложилось какое-то пессимистическое впечателние.
Вывод был примерно таков: «Ситуация с библиотеками не позволяет
использовать Python 3», а иными словами, пока не готово для продакшена.
Не удалось завести django-celery под py3k, а стало быть запускать даже в стейджинг такое нельзя.
Но ведь это не повод отчаиваться :) Возникло желание продемонстрировать, что некоторые проекты уже сейчас
можно перевести на трёшку. Кандидата не пришлось долго искать: <a href="http://moscowdjango.ru/">сайт Moscow Django</a>
для этого отлично подошёл.</p>
<h3>Портируем на счёт три</h3>
<p>Если кода немного, то портирование на python 3 обычно более-менее тривиально. Особенно помогает
понимание того, что изменилось. А более всего осознание <a href="http://nedbatchelder.com/text/unipain.html">разницы между юникодом и строками</a>.
В своём выступлении я рекомендовал книжку <a href="http://python3porting.com/">Porting to Python 3</a> и библиотку <a href="http://pythonhosted.org/six/">six</a>, которая
де-факто стала стандартом разработки софта сразу под 2.x и 3.x. Этот подход избрали авторы множества
известных мне библиотек, и не напрасно. Я считаю, что это намного проще в поддержке, чем 2to3
и уж точно удобней, чем писать свои слои абстракции для совместимости.</p>
<p>Для начала надо было решить, как завести свеженький питон на Хероку, где хостится MoscowDjango.
К счастью, до того, как я погрузился в особенности устройства местных билдпаков,
Kenneth Reitz анонсировал официальную поддержку всех актуальных версий питона на Хероку.
Оставалось адаптировать код сайта и все зависимости.</p>
<p>Поскольку код сайта достаточно компактен, большую часть времени заняли чужие библиотеки.
Из <a href="https://github.com/futurecolors/moscowdjango/issues/64">21 пакета</a> лишь 7 уже могли запускаться под py3k, ещё для 6 нашлись рабочие форки, а ещё 3 я спортировал сам.
Стоит отметить, что пакеты без тестов или хорошего покрытия портировать на python 3 крайне тяжело,
а иногда даже невозможно. Это ещё один достаточно весомый довод в пользу написания тестов для
вашего проекта.</p>
<h3>Ложка дёгтя</h3>
<p>Больше всего проблем доставила <a href="https://crate.io/packages/django-storages/">django-storages</a>, с помощью которой осуществляется заливка
медиа-файлов на амазоновский s3. Выкинуть её полностью или заменить аналогом не получилось,
а по-честному спортировать в короткий срок нереально из-за зависимости на внушительный <a href="https://crate.io/packages/boto/">boto</a>,
до сих пор возглавляющий <a href="http://python3wos.appspot.com/">python 3 wall of shame</a>. Пришлось вытащить на свет
deprecated версию python API от амазона бородатого года под python 2.4 и кое-как приспособить для
своих нужд.</p>
<p>К сожалению, перевести все-все зависимости на новую версию языка не удалось из-за временных
ограничений (хотел успеть к докладу). За бортом прогресса плещутся любимые django-debug-toolbar и
django-admin-sso, ожидая своей очереди. Но и без них сайт прекрасно работает, а никто и не заметил,
что они были.</p>
<h3>Выводы</h3>
<p>Итого, меньше, чем за месяц (в свободное время) получилось запустить в продакшене небольшой <a href="http://moscowdjango.ru/">сайт на
Django 1.5c1</a>. Конечно, это никакое не достижение, просто иллюстрация тенденции: того, что авторы
библиотек всё больше с каждым годом смотрят в сторону третей версии языка. И скоро наступит момент,
когда вопрос, стартовать ли новый проект на python 3 перестанет быть лишь уделом энтузиастов.</p>
<p>Уже сейчас каждый, кто нашёл для себя что-то интересное в python 3, может начать
помогать сообществу портировать библиотеки. Вот такой вывод я хотел бы видеть в докладе.</p></div>
<div class="article-tags">
    <i class="icon-tag"></i>
	<a href="http://codecoffee.ru/tag/python.html">python</a>
	<a href="http://codecoffee.ru/tag/konferentsii.html">конференции</a>
	<a href="http://codecoffee.ru/tag/moscowdjango.html">moscowdjango</a>
</div>
            <a class="comments-link" href="http://codecoffee.ru/2013/02/python3-moscowdjango/#disqus_thread">Комментарии</a>
        </article>
        <hr />
        <article class="article">
            <h2><a href="http://codecoffee.ru/2012/10/pro-prezentatsii/">Про презентации</a></h2>
            <span class="article-date">25 October 2012</span>
            <div class="summary"><p>На <a href="http://moscowdjango.ru/meetups/7/">Moscow Django Meetup 6</a> рассказал
про свои взгляды на тестирование и поделился несколькими нехитрыми советами и инструментами.
Всем неравнодушным к совершенствованию качества кода рекомендую.
А в особенности пишущим на python и Django, но надеюсь и остальным понравится.</p>
<p>Пока что доступны слайды, но вскоре и видео подоспеет:</p>
<div style="height:500px; margin-bottom: 20px;">
<script async class="speakerdeck-embed" data-id="5087e55307a206000204d609" data-ratio="1.7777777777777777"
 src="http://speakerdeck.com/assets/embed.js"></script>
</div>

<h3>Опыт докладчика</h3>
<p>За этот год я выступил уже 3 раза на Moscow Django: в феврале рассказал про
<a href="https://speakerdeck.com/coagulant/chto-novogho-v-django-1-dot-4">новинки Django 1.4</a>, в июле про <a href="https://speakerdeck.com/coagulant/django-i-continuous-integration">Continuous Integration</a>.
Мотивация делать доклады такая же что и писать в блог: выкристаллизовать свои
собственные знания в первую очередь. Чтобы объяснить что-то другим людям,
надо самому это прекрасно понимать и разбираться. Советую попробовать, вам тоже
может понравиться. Ну и приятные побочные эффекты никто не отменял.</p>
<h3>Советы самому себе полгода назад</h3>
<p>Размер шрифта как можно больше, переборщить не получится.<br/>
Не нужно много текста, только самая суть: остальное можно рассказать.<br/>
Списки должны появляться по пунктам, а не сразу.<br/>
А лучше всего сделать по слайду на каждый пункт.<br/>
Слайдов не может быть слишком много, нельзя экономить на слайдах.<br/>
Научись пользоваться кликером, а лучше ещё и лазрной указкой, если на слайде код.<br/>
Раскрашивай код на слайдах, если кода много. Но лучше меньше кода!<br/>
Код на слайдах должен быть моноширинным, легочитаемым шрифтом.<br/>
Присылай слайды организаторам заранее, лучше ещё и бэкап в формате PDF.<br/>
Пиши комментарии докладчика и пользуйся ими во время рассказа.<br/></p>
<p>Не буду утверждать, что все советы я сам смог выполнить, но я на пути к этому.</p>
<p>P.S. Совет тем, кто не знает чем подсвечивать код в презентациях: я пользуюсь хорошей
библиотекой <a href="http://softwaremaniacs.org/soft/highlight/">highligh.js</a> и копирую html код прямо на слайд Keynote.
Для этого я сделал небольшой <a href="http://jsfiddle.net/gzUey/">плейграунд на jsfiddle</a>. Может быть и вам он пригодится.</p></div>
<div class="article-tags">
    <i class="icon-tag"></i>
	<a href="http://codecoffee.ru/tag/python.html">python</a>
	<a href="http://codecoffee.ru/tag/konferentsii.html">конференции</a>
	<a href="http://codecoffee.ru/tag/moscowdjango.html">moscowdjango</a>
</div>
            <a class="comments-link" href="http://codecoffee.ru/2012/10/pro-prezentatsii/#disqus_thread">Комментарии</a>
        </article>
        <hr />
        <article class="article">
            <h2><a href="http://codecoffee.ru/2012/09/opensors-na-angliiskom/">Опенсорс на английском</a></h2>
            <span class="article-date">30 September 2012</span>
            <div class="summary"><p>Проекты с открытым исходным кодом должны быть на английском.
Без исключений: документация, комментарии в коде, багтрекер в опенсорс-мире should be in English.
При желании можно делать переводы доков на разные языки, но обычно их качество и актуальность оставляют желать лучшего.
Основной мотив не делать проект исключительно на русском/немецком/испанском и т.п. это
возможность привлечения как можно более широкой аудитории. Это касаестя как userbase девелоперов
(им важна англоязычная документация и поддержка), так и коллег-контрибуторов (им также
пригодятся понятные без словаря комментарии в коде и тексты коммитов).</p>
<p>Не замыкайтесь на русскоязычную аудиторию, она не составляет и десятой доли пользователей интернета (гитхаба).
Даже если ваш проект пока что целиком ориентирован на локальный сегмент, вам
вовсе не обязательно заранее ограничивать себя, ведь подавляющее большинство разработчиков знают английский язык
и умеют на нём хотя бы читать.</p>
<p>На написание поста сподвиг вот этот <a href="https://twitter.com/banzalik/status/251607430876758017">твит</a>,
и некоторые обсуждения в нашей команде. Поначалу делать <a href="https://github.com/futurecolors/moscowdjango">проект для русскоязычной аудитории</a>
с сорцами и коммитами на английском может показаться оверкиллом, но со временем это обязательно
<a href="https://github.com/futurecolors/moscowdjango/issues/13">принесёт свою пользу</a>.</p></div>
<div class="article-tags">
    <i class="icon-tag"></i>
	<a href="http://codecoffee.ru/tag/opensource.html">opensource</a>
</div>
            <a class="comments-link" href="http://codecoffee.ru/2012/09/opensors-na-angliiskom/#disqus_thread">Комментарии</a>
        </article>
        <hr />
        <article class="article">
            <h2><a href="http://codecoffee.ru/2012/09/novyi-dvizhok-bloga/">Новый движок блога</a></h2>
            <span class="article-date">13 September 2012</span>
            <div class="summary"><p>Пришла пора отказаться от вордпресса в пользу легко настраиваемого <a href="http://getpelican.com">Pelican</a>.</p>
<p>Вы наверняка слышали про "статические" блоги, которые рендерятся из Markdown-разметки,
самый популярный, конечно же, <a href="http://octopress.org">Octopress</a> на основе <a href="http://jekyllrb.com/">Jekyll</a>. Отличная платформа,
с прекрасной стандартной темой, но, к сожалению, на Ruby. Решил не полениться и перенёс
свой бложек на похожий движок, но на питоне. Так привычней и проще настраивать под себя,
да и геморроя с rvm нет. Зато налицо полное отсутсвтие хоть сколько-нибудь приятных
стандартных шаблонов, все они ужасны чуть менее чем полностью.</p>
<p>Писать статьи прямо .md или .rst привычно и удобно для программистов и прочих гиков,
авось и новые статьи начнут появляться тут.</p></div>
<div class="article-tags">
    <i class="icon-tag"></i>
	<a href="http://codecoffee.ru/tag/python.html">python</a>
</div>
            <a class="comments-link" href="http://codecoffee.ru/2012/09/novyi-dvizhok-bloga/#disqus_thread">Комментарии</a>
        </article>
        <hr />
        <article class="article">
            <h2><a href="http://codecoffee.ru/2011/09/tvity-future-colors-3-nedelia-sentiabria/">Твиты Future Colors, 3 неделя сентября</a></h2>
            <span class="article-date">26 September 2011</span>
            <div class="summary"><p>Мы ежедневно делимся в твитере <a href="http://twitter.com/#!/futurecolors">@futurecolors</a> полезными ссылками,
новостями вебразработки, еженедельно — фотками с работы. Раз в
неделю-две я буду собирать всё это в один пост, чтобы это легко было
найти потом. Хронология специально нарушена, это не так важно. Кое-где
мои комментарии к твитам.</p>
<h3>Django</h3>
<blockquote>
<p><a href="http://twitter.com/#!/isagalaev">Иван Сагалаев</a> в своём блоге <a href="http://softwaremaniacs.org/blog/2011/09/08/djangocon-2011/">делится впечатлениями</a> о прошедешем
DjangoCon US.</p>
<p>Опубликованы <a href="http://blip.tv/djangocon">видеозаписи с DjangoCon US 2011</a> Всем смотреть!</p>
</blockquote>
<p>Целых 40 записей, 16 гигабайт видео, часов ещё больше. Смотрите
<a href="http://djangocon.us/schedule/">описания выступлений</a> и изучайте, это очень интересно.</p>
<blockquote>
<p>А вы уже <a href="https://www.djangoproject.com/weblog/2011/sep/09/security-releases-issued/">обновили django до 1.3.1</a> и 1.2.7 соответственно?</p>
</blockquote>
<p>Благодаря <a href="http://packages.python.org/django-fab-deploy/">django-fab-deploy</a>, обновить фреймворк не составило особого
труда.</p>
<blockquote>
<p>Хорошая заметка о <a href="http://lucumr.pocoo.org/2011/7/19/sqlachemy-and-you/">различиях между Django ORM и SQLAlchemy</a>. Ещё
<a href="http://habrahabr.ru/blogs/python/128052/">холивор с похожей темой</a></p>
<p><a href="http://djangrrl.com/view/contributing-django-documentation-part-1-generating-and-editing-documentation-locally/">Как помочь улучшить документацию django</a> (две заметки из блога
девушки с татуировкой пони). <a href="http://djangrrl.com/view/contributing-django-documentation-part-2-submitting-patch/">Вторая</a></p>
<p><a href="https://github.com/dmpayton/django-admin-honeypot/">Подменяем /admin/ фальшивой авторизацией</a> и следим за "хакерами"</p>
<p>Наконец-то начались какие-то<a href="https://code.djangoproject.com/browser/django/branches/features/py3k/">попытки портировать Django на python3</a></p>
</blockquote>
<p>Ветка теперь доступна и на <a href="https://github.com/django/django/tree/features/py3k">гитхабе</a></p>
<blockquote>
<p>На новых проектах будем использовать <a href="https://github.com/kmmbvnr/django-jenkins">django-jenkins</a> и
<a href="https://github.com/kmmbvnr/django-any">django-any</a>. Очень полезные штуки.</p>
</blockquote>
<p>Используем ежедневно. не без недостатков, но очень правильные идеи.</p>
<blockquote>
<p>JetBrains радуют новыми фичами и апдейтами старых. <a href="http://blog.jetbrains.com/pycharm/2011/09/django-templates-debugging-with-pycharm/">Пост из блога
pycharm про дебаг шаблонов джанги</a> в их IDE</p>
</blockquote>
<h3>HTML и Javascript</h3>
<blockquote>
<p><a href="http://mobilehtml5.org">Какие фичи html5 поддерживают мобильные браузеры</a>. Полезная
табличка</p>
<p><a href="https://github.com/zgrossbart/jslim">Утилита для вырезания из js-библиотек неспользуемого вами кода</a>.
Насколько хорошо она почикает jquery?</p>
</blockquote>
<h3>CoffeeScript (и django)</h3>
<blockquote>
<p>Весёлая презентация <a href="http://bodil.github.com/coffeescript/">CoffeeScript: JavaScript without the Fail</a></p>
<p>Думаете только поклонники руби уважают CoffeeScript? Всовсе нет,
например: <a href="http://pypi.python.org/pypi/django-coffeescript/">django-coffeescript</a></p>
<p>Впрочем, необязательно ставить дополнительный пакет, достаточно нашего
любимого <a href="https://github.com/jezdez/django_compressor">django-compressor</a> (django + coffeescript)</p>
</blockquote>
<p>Всерьёз задумались о внедрении кофескрипта как замены js на будущих
проектах.</p>
<h3>Разработка</h3>
<blockquote>
<p><a href="http://book.git-scm.com/5_finding_issues_-_git_bisect.html">Команда git bisect</a> выручает при борьбе с нетривиальными
регрессиями. Очень полезно</p>
<p>Познавательно про <a href="http://habrahabr.ru/company/skbkontur/blog/128427/">разработку в СКБ Контур</a></p>
</blockquote>
<p><img alt="Проектирование моделей (тех самых, которые являются частью
  MVC). На фото - Илья Барышев" src="http://prophet.ru/media/models-600x400.jpg" /></p></div>
            <a class="comments-link" href="http://codecoffee.ru/2011/09/tvity-future-colors-3-nedelia-sentiabria/#disqus_thread">Комментарии</a>
        </article>
        <hr />
        <article class="article">
            <h2><a href="http://codecoffee.ru/2011/08/boremsia-s-clickjacking/">Боремся с Clickjacking</a></h2>
            <span class="article-date">21 August 2011</span>
            <div class="summary"><h3>Что такое clickjacking</h3>
<p>Clickjacking - относительно новый и не очень широко известный тип атак
на веб-сайты. Его суть в том, что пользователь, совершая клик на
специально сформированной странице злоумышленника, на самом деле кликает
по ссылке на совершенно другом сайте. Это может быть использовано как
для относительно безобидных накруток голосований (например, <a href="http://shiflett.org/blog/2009/feb/twitter-dont-click-exploit">ретвитов</a>
или <a href="http://erickerr.com/like-clickjacking">лайков</a>), так и более разрушительных вещей, главное, чтобы для
этого требовался щелчок мыши.</p>
<h3>Как это работает</h3>
<p>Атакуемый сайт оборачивается в прозрачный ифрейм. Поверх него
располагают какую-нибудь привлекательную ссылку, на которую захочет
кликнуть «жертва» (при атаке на твитер в 2009 такой приманкой стала
кнопка c текстом «Don't click»). Теперь вместо клика на неё будет
происходить клик в ифрейме (так как он находится поверх кнопки).</p>
<h3><a href="/demos/clickjacking/">Демонстрация кликджекинга</a></h3>
<p>(абсолютно безвредно) Замечу, что защита от clickjacking совершенно
иная, чем от CSRF, хотя цели злоумышленников в обоих атаках - заставить
пользователя совершить запрос к сайту под своими правами.</p>
<h3>Защищаемся через javascript</h3>
<p>Самый простой способ - сделать редирект с помощью js, если сайт открыт в
ифрейме (<a href="http://prophet.ru/demos/clickjacking/attacker_simple_defence.php">пример</a>):</p>
<div class="highlight"><pre><span class="k">if</span><span class="p">(</span><span class="n">top</span><span class="err"> </span><span class="o">!=</span> <span class="n">self</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">top</span><span class="p">.</span><span class="n">location</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">location</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>К сожалению, это код неуниверсален, существуют несколько способов его
обхода разной степени изощрённости и применимости в браузерах. Подробнее
можно почитать в исследовании <a href="http://crypto.stanford.edu/~dabo/pubs/papers/framebust.pdf">Busting Frame Busting: a Study of
Clickjacking Vulnerabilities on Popular Sites</a>.</p>
<h3>Защищаемся через заголовки</h3>
<p>В дополнение к предыдущему методу, разработчики браузеров ввели новый
заголовок ответа сервера <a href="https://developer.mozilla.org/en/The_X-FRAME-OPTIONS_response_header">X-Frame-Options</a>. Он позволяет не отображать
сайт, если он загружается c другого домена через ифрейм. Пример настроек
для Apache и nginx:</p>
<div class="highlight"><pre><span class="n">Header</span> <span class="n">always</span> <span class="n">append</span> <span class="n">X</span><span class="o">-</span><span class="n">Frame</span><span class="o">-</span><span class="n">Options</span> <span class="n">SAMEORIGIN</span>

<span class="n">add_header</span> <span class="n">X</span><span class="o">-</span><span class="n">Frame</span><span class="o">-</span><span class="n">Options</span> <span class="n">SAMEORIGIN</span><span class="p">;</span>
</pre></div>


<p>Работает в IE 8.0+, FF 3.6.9+, Opera 10.50+, Safari 4.0+ и Chrome 4.1+,
на момент написания поста по рунету это более 70% пользователей.</p>
<p>В новой версии Django 1.4 для добавления этого заголовка есть настраиваемый
<a href="https://docs.djangoproject.com/en/dev/ref/clickjacking/">XFrameOptionsMiddleware</a>.</p>
<p><a href="http://www.owasp.org/index.php/Clickjacking">Подробно про Clickjacking</a> на сайте Open Web Application Security Project.</p></div>
<div class="article-tags">
    <i class="icon-tag"></i>
	<a href="http://codecoffee.ru/tag/security.html">security</a>
</div>
            <a class="comments-link" href="http://codecoffee.ru/2011/08/boremsia-s-clickjacking/#disqus_thread">Комментарии</a>
        </article>
        <hr />
        <article class="article">
            <h2><a href="http://codecoffee.ru/2010/12/httponly-kuki-i-s-chem-ikh-ediat/">HttpOnly куки и с чем их едят</a></h2>
            <span class="article-date">20 December 2010</span>
            <div class="summary"><p>HttpOnly cookie — это такие куки, которые невозможно прочитать с помощью
javascript, но доступные серверным скриптам, как и любые другие.
Несмотря на то, что это совсем не новая технология (HttpOnly cookie
появились 8 лет назад в IE6 SP1), далеко не все знают, почему их
обязательно стоит использовать.</p>
<h3>Зачем это нужно</h3>
<p>Куки, недоступные из джаваскипта, помогут защитить от XSS-атак, как
второй рубеж обороны от злоумышленников. Прокравшийся на страницу
вредоносный код не сможет утащить пользовательские куки с помощью
<code>document.cookie</code>.</p>
<h3>Где это работает</h3>
<p>Основная мысль: <em>это работает во всех популярных и современных
браузерах</em> (IE6+, Firefox 2.0+, Chrome 1.0+, Opera 9.5+, Safari 4.0+)
Подробнее можно ознакомиться на сайте <a href="http://www.browserscope.org/">browserscope</a> (раздел
Security).</p>
<p>HttpOnly cookie <a href="http://php.net/manual/en/function.setcookie.php">легко установить в php</a>, <a href="http://docs.djangoproject.com/en/dev/ref/request-response/#django.http.HttpResponse.set_cookie">django</a>. Чтобы
установить куки собственноручно через передачу заголовка ответа,
достаточко добавить параметр <code>; HttpOnly</code></p>
<div class="highlight"><pre><span class="n">Set</span><span class="o">-</span><span class="n">Cookie</span><span class="o">:</span> <span class="o">=</span><span class="p">[;</span> <span class="o">=</span><span class="p">]</span>
<span class="p">[;</span> <span class="n">expires</span><span class="o">=</span><span class="p">][;</span> <span class="n">domain</span><span class="o">=</span><span class="p">]</span>
<span class="p">[;</span> <span class="n">path</span><span class="o">=</span><span class="p">][;</span> <span class="n">secure</span><span class="p">][;</span> <span class="n">HttpOnly</span><span class="p">]</span>
</pre></div>


<p><a href="http://prophet.ru/demos/cookie/">Демо</a></p>
<p><a href="http://www.owasp.org/index.php/HttpOnly">Подробно про HttpOnly cookie</a> на сайте Open Web Application Security Project</p></div>
<div class="article-tags">
    <i class="icon-tag"></i>
	<a href="http://codecoffee.ru/tag/security.html">security</a>
</div>
            <a class="comments-link" href="http://codecoffee.ru/2010/12/httponly-kuki-i-s-chem-ikh-ediat/#disqus_thread">Комментарии</a>
        </article>
        <hr />
        <article class="article">
            <h2><a href="http://codecoffee.ru/2010/12/vpc-ec3s1r-i-ubunta-1010/">VPC-EC3S1R и Убунта 10.10</a></h2>
            <span class="article-date">15 December 2010</span>
            <div class="summary"><p>Взамен <a href="http://www.trustedreviews.com/laptops/review/2005/09/07/Fujitsu-Siemens-AMILO-M3438G-Gaming-Notebook/p1">старого ноута</a> приобрёл новый <a href="http://market.yandex.ru/model.xml?modelid=6496796">VAIO серии E</a>. Машинка отличная,
а пока пара советов для убунтоводов, обзаведшихся ноутом сони, почерпнутых в <a href="http://outhereinthefield.wordpress.com/2010/11/03/ubuntu-10-4-lucid-lynx-on-vaio-vpcea36fg/">одном из
блогов</a>.</p>
<p><img alt="Sony VAIO VPC-EC3S1R" src="http://prophet.ru/media/vaio.jpg" /></p>
<p>Под свежеустановленным
Мавериком (10.10) почти всё завелось "из коробки": видео, аудио,
вебкамера, но не обошлось и без досадных недоразумений в виде нерабочего
тачпада и кнопок управления яркости.</p>
<h3>Убунта и яркость экрана</h3>
<p>Сидеть за дисплеем со 100-процентной яркостью совершенно невозможно,
поэтому, пока не отказали глаза срочно понижаем её в меню "Система →
Параметры → Управления питанием". Данный трюк не проходит, если питание
от сети отсутствует, поэтому надо оживить кнопки Fn+F5 и Fn+F6,
отвечающие за яркость.</p>
<p>1) Правим файл <code>/etc/acpi/events/sony-brightness-down</code>, который будет выполняться при
нажатии Fn+F5.</p>
<div class="highlight"><pre><span class="cp"># /etc/acpi/events/sony-brightness-down</span>
<span class="n">event</span><span class="o">=</span><span class="n">sony</span><span class="o">/</span><span class="n">hotkey</span> <span class="n">SNC</span> <span class="mo">00000001</span> <span class="mo">00000010</span>
<span class="n">action</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">acpi</span><span class="o">/</span><span class="n">brightdown</span><span class="p">.</span><span class="n">sh</span>
</pre></div>


<p>Код клавиши может отличаться для других моделей ноутбуков Сони (можно
определить с помощью команды <code>acpi_listen</code>)</p>
<p>2) Правим скрипт <code>/etc/acpi/brightdown.sh</code>, который понижает яркость</p>
<div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="nv">curr</span><span class="o">=</span><span class="sb">`</span>cat /sys/class/backlight/acpi_video0/actual_brightness<span class="sb">`</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$curr</span> -gt 0 <span class="o">]</span>; <span class="k">then</span>
<span class="nv">curr</span><span class="o">=</span><span class="k">$((</span>curr-1<span class="k">))</span>;
<span class="nb">echo</span> <span class="nv">$curr</span>  &gt; /sys/class/backlight/acpi_video0/brightness;
<span class="k">fi</span>
</pre></div>


<p>Главное, не забыть про права на исполнение.</p>
<p>3) Аналогично редактируем файл <code>/etc/acpi/events/sony-brightness-up</code></p>
<div class="highlight"><pre><span class="cp"># /etc/acpi/events/sony-brightness-up</span>
<span class="n">event</span><span class="o">=</span><span class="n">sony</span><span class="o">/</span><span class="n">hotkey</span> <span class="n">SNC</span> <span class="mo">00000001</span> <span class="mo">00000011</span>
<span class="n">action</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">acpi</span><span class="o">/</span><span class="n">brightup</span><span class="p">.</span><span class="n">sh</span>
</pre></div>


<p>4) А вот скрипт повышения яркости для файла <code>/etc/acpi/brightup.sh</code></p>
<div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="nv">curr</span><span class="o">=</span><span class="sb">`</span>cat /sys/class/backlight/acpi_video0/actual_brightness<span class="sb">`</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$curr</span> -lt 8 <span class="o">]</span>; <span class="k">then</span>
<span class="nv">curr</span><span class="o">=</span><span class="k">$((</span>curr+1<span class="k">))</span>;
<span class="nb">echo</span> <span class="nv">$curr</span>  &gt; /sys/class/backlight/acpi_video0/brightness;
<span class="k">fi</span>
</pre></div>


<h3>Убунта и тачпад</h3>
<p>Тачпад особенно не нужен на 17-дюймовом ноуте, который заменяет десктоп,
но для порядка надо оживить и его. Нужно отредактировать
<code>/etc/default/grub</code>, добавив следующую строчку</p>
<div class="highlight"><pre><span class="n">GRUB_CMDLINE_LINUX</span><span class="o">=</span><span class="err">”</span><span class="n">i8042</span><span class="p">.</span><span class="n">noloop</span> <span class="n">i8042</span><span class="p">.</span><span class="n">nomux</span> <span class="n">i8042</span><span class="p">.</span><span class="n">reset</span> <span class="n">i8042</span><span class="p">.</span><span class="n">nopnp</span> <span class="n">splash</span><span class="s">&quot;</span>
</pre></div>


<p>После этого надо пересоздать grub.conf</p>
<div class="highlight"><pre><span class="n">sudo</span> <span class="n">update</span><span class="o">-</span><span class="n">grub</span>
</pre></div>


<p>После этого перезагружаемся и тачпад работает. Удачной работы.</p></div>
<div class="article-tags">
    <i class="icon-tag"></i>
	<a href="http://codecoffee.ru/tag/ubuntu.html">ubuntu</a>
</div>
            <a class="comments-link" href="http://codecoffee.ru/2010/12/vpc-ec3s1r-i-ubunta-1010/#disqus_thread">Комментарии</a>
        </article>
        <hr />
        <article class="article">
            <h2><a href="http://codecoffee.ru/2010/11/den-rozhdeniia-api-iandekskart/">День рождения API Яндекс.Карт</a></h2>
            <span class="article-date">29 November 2010</span>
            <div class="summary"><p>В пятницу команда Яндекс.Карт вместе с активистами <a href="http://clubs.ya.ru/mapsapi/">клуба</a> отмечали
двухлетие API и предоставили возможность рассказать про наш скромный
проект «<a href="http://bankomator.ru">Банкоматор</a>». Послушали <a href="http://video.yandex.ru/users/vaddoo/view/4">любопытное выступление Кащея</a> про
то, как работает продвинутая кластеризация, как сильно ускорить вывод
объектов на карте и без хотспотов. А также <a href="http://video.yandex.ru/users/vaddoo/view/3#hq">немного статистики</a> о том,
как растёт и становится лучше API карт. Очень здорово, что поддержка в
клубе такая оперативная и полная. А вот <a href="http://ymapsapi.ya.ru/replies.xml?item_no=104">фото и видео со встречи</a>.</p>
<p>Народу было немного, познакомились с командой, кого не видели на
<a href="http://habrahabr.ru/blogs/yandex/79266/">прошлогоднем семинаре</a>. Встреча закончилась вкусным тортом и
небольшой экскурсию по офису. Спасибо!</p>
<p><img alt="Фото на память" src="http://prophet.ru/media/0_3847d_675c29f1_orig.jpg" /></p></div>
<div class="article-tags">
    <i class="icon-tag"></i>
	<a href="http://codecoffee.ru/tag/sobytiia.html">события</a>
	<a href="http://codecoffee.ru/tag/iandeks.html">Яндекс</a>
</div>
            <a class="comments-link" href="http://codecoffee.ru/2010/11/den-rozhdeniia-api-iandekskart/#disqus_thread">Комментарии</a>
        </article>
        <hr />

        <div class="pagination">
        <ul>
                        <li class="prev disabled"><a href="#">&larr; Previous</a></li>
                        <li class="active"><a href="http://codecoffee.ru/author/ilia-baryshev.html">1</a></li>
                        <li class=""><a href="http://codecoffee.ru/author/ilia-baryshev2.html">2</a></li>
                        <li class="next"><a href="http://codecoffee.ru/author/ilia-baryshev2.html">Next &rarr;</a></li>
        </ul>
        </div>

        </div>

        <div class="span4" id="sidebar">
<div class="twitter-widget">
<a class="twitter-timeline" href="https://twitter.com/coagulant"
   data-widget-id="246305220399861761">Твитер @coagulant</a>
</div>
<script>!function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (!d.getElementById(id)) {
        js = d.createElement(s);
        js.id = id;
        js.src = "http://platform.twitter.com/widgets.js";
        fjs.parentNode.insertBefore(js, fjs);
    }
}(document, "script", "twitter-wjs");</script>        </div>

    </div>

    <hr>
</div>

<script type="text/javascript">
    var disqus_shortname = 'ilyabaryshev';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

<script src="http://codecoffee.ru/theme/js/jquery-1.7.2.min.js"></script>
<script src="http://codecoffee.ru/theme/js/bootstrap.min.js"></script>
</body>
</html>